<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="576px" preserveAspectRatio="none" style="width:1978px;height:576px;" version="1.1" viewBox="0 0 1978 576" width="1978px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ji4030i7gozf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[8fb2198dc390c4eafe4a3760c0457e6d]
class Configurator--><rect fill="#FEFECE" filter="url(#f1ji4030i7gozf)" height="86.4141" id="Configurator" style="stroke: #A80036; stroke-width: 1.5;" width="293" x="574.5" y="472.5"/><ellipse cx="677.75" cy="488.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M680.7188,494.1406 Q680.1406,494.4375 679.5,494.5781 Q678.8594,494.7344 678.1563,494.7344 Q675.6563,494.7344 674.3281,493.0938 Q673.0156,491.4375 673.0156,488.3125 Q673.0156,485.1875 674.3281,483.5313 Q675.6563,481.875 678.1563,481.875 Q678.8594,481.875 679.5,482.0313 Q680.1563,482.1875 680.7188,482.4844 L680.7188,485.2031 Q680.0938,484.625 679.5,484.3594 Q678.9063,484.0781 678.2813,484.0781 Q676.9375,484.0781 676.25,485.1563 Q675.5625,486.2188 675.5625,488.3125 Q675.5625,490.4063 676.25,491.4844 Q676.9375,492.5469 678.2813,492.5469 Q678.9063,492.5469 679.5,492.2813 Q680.0938,492 680.7188,491.4219 L680.7188,494.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="78" x="698.25" y="492.6543">Configurator</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="575.5" x2="866.5" y1="504.5" y2="504.5"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="580.5" y="518.7104">note:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="244" x="617.5" y="518.7104">loading and handling of config information.</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="580.5" y="531.5151">note:</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="216" x="617.5" y="531.5151">print selected configuration formatted</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="580.5" y="544.3198">to the console</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="575.5" x2="866.5" y1="550.9141" y2="550.9141"/><!--MD5=[69f2f3ad3645114d26612368d508f737]
class Printer--><rect fill="#FEFECE" filter="url(#f1ji4030i7gozf)" height="73.6094" id="Printer" style="stroke: #A80036; stroke-width: 1.5;" width="206" x="391" y="54"/><ellipse cx="468.75" cy="70" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M471.7188,75.6406 Q471.1406,75.9375 470.5,76.0781 Q469.8594,76.2344 469.1563,76.2344 Q466.6563,76.2344 465.3281,74.5938 Q464.0156,72.9375 464.0156,69.8125 Q464.0156,66.6875 465.3281,65.0313 Q466.6563,63.375 469.1563,63.375 Q469.8594,63.375 470.5,63.5313 Q471.1563,63.6875 471.7188,63.9844 L471.7188,66.7031 Q471.0938,66.125 470.5,65.8594 Q469.9063,65.5781 469.2813,65.5781 Q467.9375,65.5781 467.25,66.6563 Q466.5625,67.7188 466.5625,69.8125 Q466.5625,71.9063 467.25,72.9844 Q467.9375,74.0469 469.2813,74.0469 Q469.9063,74.0469 470.5,73.7813 Q471.0938,73.5 471.7188,72.9219 L471.7188,75.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="42" x="489.25" y="74.1543">Printer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="392" x2="596" y1="86" y2="86"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="392" x2="596" y1="94" y2="94"/><ellipse cx="402" cy="105" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="411" y="108.2104">reset_count()</text><ellipse cx="402" cy="117.8047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="180" x="411" y="121.0151">print(state : str, message : str)</text><path d="M70,35.5 L70,136.2969 A0,0 0 0 0 70,136.2969 L356,136.2969 A0,0 0 0 0 356,136.2969 L356,89.8984 L395,117.207 L356,81.8984 L356,45.5 L346,35.5 L70,35.5 A0,0 0 0 0 70,35.5 " fill="#FBFB77" filter="url(#f1ji4030i7gozf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M346,35.5 L346,45.5 L356,45.5 L346,35.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="81.5" cy="48.1328" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="252" x="87" y="52.5669">print to console in standardised format.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="76" y="67.6997">Example: [ 1 ][ OK ][ "message" ]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="80" y="82.8325"/><ellipse cx="81.5" cy="93.5313" fill="#000000" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="254" x="87" y="97.9653">maybe also provide an option to log the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="76" y="113.0981">current session in txt/log file. Allows,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="76" y="128.231">analysing/comparing runs late on.</text><!--MD5=[8d729038c48ea67d1bfca0b0b8d717df]
class Loader--><rect fill="#FEFECE" filter="url(#f1ji4030i7gozf)" height="73.6094" id="Loader" style="stroke: #A80036; stroke-width: 1.5;" width="147" x="537.5" y="283"/><ellipse cx="585.25" cy="299" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M588.2188,304.6406 Q587.6406,304.9375 587,305.0781 Q586.3594,305.2344 585.6563,305.2344 Q583.1563,305.2344 581.8281,303.5938 Q580.5156,301.9375 580.5156,298.8125 Q580.5156,295.6875 581.8281,294.0313 Q583.1563,292.375 585.6563,292.375 Q586.3594,292.375 587,292.5313 Q587.6563,292.6875 588.2188,292.9844 L588.2188,295.7031 Q587.5938,295.125 587,294.8594 Q586.4063,294.5781 585.7813,294.5781 Q584.4375,294.5781 583.75,295.6563 Q583.0625,296.7188 583.0625,298.8125 Q583.0625,300.9063 583.75,301.9844 Q584.4375,303.0469 585.7813,303.0469 Q586.4063,303.0469 587,302.7813 Q587.5938,302.5 588.2188,301.9219 L588.2188,304.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="43" x="605.75" y="303.1543">Loader</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="538.5" x2="683.5" y1="315" y2="315"/><ellipse cx="548.5" cy="326" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="45" x="557.5" y="329.2104">FID: dict</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="538.5" x2="683.5" y1="335.8047" y2="335.8047"/><ellipse cx="548.5" cy="346.8047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="557.5" y="350.0151">load_jMRUI(path : str)</text><path d="M232,287.5 L232,342.8984 A0,0 0 0 0 232,342.8984 L502,342.8984 A0,0 0 0 0 502,342.8984 L502,319.1992 L541.5,325.4023 L502,311.1992 L502,297.5 L492,287.5 L232,287.5 A0,0 0 0 0 232,287.5 " fill="#FBFB77" filter="url(#f1ji4030i7gozf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M492,287.5 L492,297.5 L502,297.5 L492,287.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="238" y="304.5669">Example:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="238" y="319.6997">FID["signal"] -&gt; np.array</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="238" y="334.8325">FID["parameters"]["LarmorFreq"] -&gt; int</text><path d="M1355.5,300 L1355.5,340.2656 L1612.5,340.2656 L1612.5,310 L1602.5,300 L1355.5,300 " fill="#FBFB77" filter="url(#f1ji4030i7gozf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1602.5,300 L1602.5,310 L1612.5,310 L1602.5,300 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="1361.5" y="317.0669">Instance of this class can be used to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="1365.5" y="332.1997">load lipids or metabolites.</text><!--MD5=[685d6ec15f3caaaf2ddc1ca659765db7]
class Mask--><rect fill="#FEFECE" filter="url(#f1ji4030i7gozf)" height="99.2188" id="Mask" style="stroke: #A80036; stroke-width: 1.5;" width="188" x="351" y="466"/><ellipse cx="424.75" cy="482" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M427.7188,487.6406 Q427.1406,487.9375 426.5,488.0781 Q425.8594,488.2344 425.1563,488.2344 Q422.6563,488.2344 421.3281,486.5938 Q420.0156,484.9375 420.0156,481.8125 Q420.0156,478.6875 421.3281,477.0313 Q422.6563,475.375 425.1563,475.375 Q425.8594,475.375 426.5,475.5313 Q427.1563,475.6875 427.7188,475.9844 L427.7188,478.7031 Q427.0938,478.125 426.5,477.8594 Q425.9063,477.5781 425.2813,477.5781 Q423.9375,477.5781 423.25,478.6563 Q422.5625,479.7188 422.5625,481.8125 Q422.5625,483.9063 423.25,484.9844 Q423.9375,486.0469 425.2813,486.0469 Q425.9063,486.0469 426.5,485.7813 Q427.0938,485.5 427.7188,484.9219 L427.7188,487.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="32" x="445.25" y="486.1543">Mask</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="352" x2="538" y1="498" y2="498"/><ellipse cx="362" cy="509" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="59" x="371" y="512.2104">FOV : float</text><ellipse cx="362" cy="521.8047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="371" y="525.0151">slice_thickness : float</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="352" x2="538" y1="531.6094" y2="531.6094"/><ellipse cx="362" cy="542.6094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="371" y="545.8198">load_nii(path: str)</text><ellipse cx="362" cy="555.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="162" x="371" y="558.6245">interpolation(voxel_size : int)</text><path d="M6,480 L6,550.5313 A0,0 0 0 0 6,550.5313 L316,550.5313 A0,0 0 0 0 316,550.5313 L316,519.5 L350.8,515.5 L316,511.5 L316,490 L306,480 L6,480 A0,0 0 0 0 6,480 " fill="#FBFB77" filter="url(#f1ji4030i7gozf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M306,480 L306,490 L316,490 L306,480 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="12" y="497.0669">Instance can load and handle: B0 Map,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="281" x="16" y="512.1997">Metabolite Mask, Fat Mask. For interpolation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="16" y="527.3325">possible PyTorch (form 1,1,x,y,z) or</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="16" y="542.4653">scipy.ndimage with (x,y,z).</text><!--MD5=[2d8d586ff196d94614c151aa4d04561c]
class MRSIBuilder--><rect fill="#FEFECE" filter="url(#f1ji4030i7gozf)" height="124.8281" id="MRSIBuilder" style="stroke: #A80036; stroke-width: 1.5;" width="195" x="632.5" y="28.5"/><ellipse cx="689.75" cy="44.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M692.7188,50.1406 Q692.1406,50.4375 691.5,50.5781 Q690.8594,50.7344 690.1563,50.7344 Q687.6563,50.7344 686.3281,49.0938 Q685.0156,47.4375 685.0156,44.3125 Q685.0156,41.1875 686.3281,39.5313 Q687.6563,37.875 690.1563,37.875 Q690.8594,37.875 691.5,38.0313 Q692.1563,38.1875 692.7188,38.4844 L692.7188,41.2031 Q692.0938,40.625 691.5,40.3594 Q690.9063,40.0781 690.2813,40.0781 Q688.9375,40.0781 688.25,41.1563 Q687.5625,42.2188 687.5625,44.3125 Q687.5625,46.4063 688.25,47.4844 Q688.9375,48.5469 690.2813,48.5469 Q690.9063,48.5469 691.5,48.2813 Q692.0938,48 692.7188,47.4219 L692.7188,50.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="710.25" y="48.6543">MRSIBuilder</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="633.5" x2="826.5" y1="60.5" y2="60.5"/><ellipse cx="643.5" cy="71.5" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="652.5" y="74.7104">FID_lipids : dict</text><ellipse cx="643.5" cy="84.3047" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="122" x="652.5" y="87.5151">FID_metabolites : dict</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="633.5" x2="826.5" y1="94.1094" y2="94.1094"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="640.5" y="102.1094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="169" x="652.5" y="108.3198">load(target : str, source : str)</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="640.5" y="114.9141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="103" x="652.5" y="121.1245">build_mrsi_lipids()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="640.5" y="127.7188"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="652.5" y="133.9292">build_mrsi_metabolites()</text><ellipse cx="643.5" cy="143.5234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="67" x="652.5" y="146.7339">build_mrsi()</text><path d="M863,8 L863,31.6992 L774.5,83.707 L863,39.6992 L863,63.3984 A0,0 0 0 0 863,63.3984 L1109,63.3984 A0,0 0 0 0 1109,63.3984 L1109,18 L1099,8 L863,8 A0,0 0 0 0 863,8 " fill="#FBFB77" filter="url(#f1ji4030i7gozf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1099,8 L1099,18 L1109,18 L1099,8 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="869" y="25.0669">Examples:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="869" y="40.1997">FID_metabolites["signal"] : np.array</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="217" x="869" y="55.3325">FID_metabolites["time"] : np.array</text><path d="M863,73.3984 L863,97.0977 L821.5,104.5117 L863,105.0977 L863,128.7969 A0,0 0 0 0 863,128.7969 L1175,128.7969 A0,0 0 0 0 1175,128.7969 L1175,83.3984 L1165,73.3984 L863,73.3984 A0,0 0 0 0 863,73.3984 " fill="#FBFB77" filter="url(#f1ji4030i7gozf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1165,73.3984 L1165,83.3984 L1175,83.3984 L1165,73.3984 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="869" y="90.4653">Either load data from path or from an</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="869" y="105.5981">simulation (class SpectralSimulator). Output</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="291" x="869" y="120.731">format from both sources should be identical.</text><path d="M863,138.7969 L863,147.3633 L719.5,142.9258 L863,155.3633 L863,163.9297 A0,0 0 0 0 863,163.9297 L1096,163.9297 A0,0 0 0 0 1096,163.9297 L1096,148.7969 L1086,138.7969 L863,138.7969 A0,0 0 0 0 863,138.7969 " fill="#FBFB77" filter="url(#f1ji4030i7gozf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1086,138.7969 L1086,148.7969 L1096,148.7969 L1086,138.7969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="869" y="155.8638">Also brings FID to spectral space.</text><!--MD5=[1113c1f8dce5bc35cbac5fa6b80c9932]
class SpectralSimulator--><rect fill="#FEFECE" filter="url(#f1ji4030i7gozf)" height="137.6328" id="SpectralSimulator" style="stroke: #A80036; stroke-width: 1.5;" width="253" x="719.5" y="251"/><ellipse cx="786.25" cy="267" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M789.2188,272.6406 Q788.6406,272.9375 788,273.0781 Q787.3594,273.2344 786.6563,273.2344 Q784.1563,273.2344 782.8281,271.5938 Q781.5156,269.9375 781.5156,266.8125 Q781.5156,263.6875 782.8281,262.0313 Q784.1563,260.375 786.6563,260.375 Q787.3594,260.375 788,260.5313 Q788.6563,260.6875 789.2188,260.9844 L789.2188,263.7031 Q788.5938,263.125 788,262.8594 Q787.4063,262.5781 786.7813,262.5781 Q785.4375,262.5781 784.75,263.6563 Q784.0625,264.7188 784.0625,266.8125 Q784.0625,268.9063 784.75,269.9844 Q785.4375,271.0469 786.7813,271.0469 Q787.4063,271.0469 788,270.7813 Q788.5938,270.5 789.2188,269.9219 L789.2188,272.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="111" x="806.75" y="271.1543">SpectralSimulator</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="720.5" x2="971.5" y1="283" y2="283"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="720.5" x2="971.5" y1="291" y2="291"/><ellipse cx="730.5" cy="302" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="739.5" y="305.2104">metabolites()</text><ellipse cx="730.5" cy="314.8047" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="38" x="739.5" y="318.0151">lipids()</text><ellipse cx="730.5" cy="327.6094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="40" x="739.5" y="330.8198">water()</text><ellipse cx="730.5" cy="340.4141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="102" x="739.5" y="343.6245">macromolecules()</text><ellipse cx="730.5" cy="353.2188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="739.5" y="356.4292">suppression(target : str)</text><ellipse cx="730.5" cy="366.0234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="227" x="739.5" y="369.2339">get_spectrum(spectra : list) -&gt; np.array</text><ellipse cx="730.5" cy="378.8281" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="739.5" y="382.0386">line broadening(spectrum : np.array)</text><path d="M1647.5,292.5 L1647.5,347.8984 L1966.5,347.8984 L1966.5,302.5 L1956.5,292.5 L1647.5,292.5 " fill="#FBFB77" filter="url(#f1ji4030i7gozf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1956.5,292.5 L1956.5,302.5 L1966.5,302.5 L1956.5,292.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="1653.5" y="309.5669">Depending on the code style it also</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="290" x="1657.5" y="324.6997">possible to create just the function simulate()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="262" x="1657.5" y="339.8325">with arguments "metabolites", "water", ...</text><path d="M1008,277.5 L1008,286.0664 L880.5,352.6211 L1008,294.0664 L1008,302.6328 A0,0 0 0 0 1008,302.6328 L1209,302.6328 A0,0 0 0 0 1209,302.6328 L1209,287.5 L1199,277.5 L1008,277.5 A0,0 0 0 0 1008,277.5 " fill="#FBFB77" filter="url(#f1ji4030i7gozf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1199,277.5 L1199,287.5 L1209,287.5 L1199,277.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="1014" y="294.5669">Arguments: "Water", "Lipids"</text><path d="M1008,312.6328 L1008,328.7656 L966.5,365.4258 L1008,336.7656 L1008,352.8984 A0,0 0 0 0 1008,352.8984 L1320,352.8984 A0,0 0 0 0 1320,352.8984 L1320,322.6328 L1310,312.6328 L1008,312.6328 A0,0 0 0 0 1008,312.6328 " fill="#FBFB77" filter="url(#f1ji4030i7gozf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1310,312.6328 L1310,322.6328 L1320,322.6328 L1310,312.6328 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="1014" y="329.6997">To get a sum of the desired spectra.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="291" x="1014" y="344.8325">For example: get_spectrum(["lipids", "water"])</text><!--MD5=[47c0793ffa82cf51aac7296c956b5711]
link Printer$$$LEFT to Printer--><!--MD5=[98b21946678bb1de718072aa9cd8a913]
link Loader$$$LEFT to Loader--><!--MD5=[f35af0040ac4a7e0bccc930b70ceef34]
link GMN9 to Loader--><path d="M1462.61,299.87 C1433.26,273.77 1377.62,229.59 1320.5,212.5 C1192.55,174.21 843.01,161.68 719.5,212.5 C685.05,226.68 655.73,257.67 636.29,282.76 " fill="none" id="GMN9-Loader" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--MD5=[c50500ab2ae5fbe58a92bc54facf995d]
link MRSIBuilder to MRSIBuilder$$$RIGHT--><!--MD5=[3f91da178a6d8bae618be35686f8a5f2]
link SpectralSimulator to GMN20--><path d="M930.22,250.99 C954.12,235.24 981.13,220.73 1008.5,212.5 C1137.03,173.83 1482.53,178.97 1612.5,212.5 C1672.27,227.92 1733.31,266.06 1770.68,292.49 " fill="none" id="SpectralSimulator-GMN20" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--MD5=[50837aa306ce3da4958117452b83b41e]
link SpectralSimulator to SpectralSimulator$$$RIGHT--><!--MD5=[caf9f429ec5a37eba71256e7bcdda7bc]
link Loader to Configurator--><path d="M631.69,357.4 C649.44,388.62 675.13,433.8 694.4,467.71 " fill="none" id="Loader-&gt;Configurator" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="696.96,472.2,695.9989,462.3981,694.4931,467.8509,689.0404,466.3451,696.96,472.2" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="676" y="432.0669">maybe using paths</text><!--MD5=[382ab8d150be5af59d353db4a37fe816]
link Loader to Mask--><path d="M579.78,357.4 C554.51,386.85 518.58,428.74 490.17,461.85 " fill="none" id="Loader-&gt;Mask" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="486.74,465.84,495.6341,461.6099,489.994,462.0437,489.5601,456.4035,486.74,465.84" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="525" y="432.0669">maybe using paths</text><!--MD5=[54389784c8cd657802a9c5d0236be678]
link MRSIBuilder to Loader--><path d="M648.13,153.66 C633.92,168.48 621.11,185.45 613,204 C604.14,224.26 602.57,248.51 603.64,269.51 " fill="none" id="MRSIBuilder-&gt;Loader" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="604.68,282.77,608.1996,276.4761,603.7435,270.8066,600.224,277.1005,604.68,282.77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="614" y="217.0669">load FID (metabolites, lipids)</text><!--MD5=[374dc57aae8e6990172ac3ee27acf425]
link MRSIBuilder to SpectralSimulator--><path d="M774.36,153.53 C784.84,169.53 795.45,187.04 804,204 C809.54,214.99 814.72,226.89 819.42,238.72 " fill="none" id="MRSIBuilder-&gt;SpectralSimulator" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="824.15,250.99,825.7334,243.9549,819.8484,239.7875,818.265,246.8226,824.15,250.99" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="812" y="217.0669">load simulated spectra</text><!--MD5=[be4b5366077db4693e6a074c47f91d32]
@startuml
class Configurator {
**note:** loading and handling of config information.
**note:** print selected configuration formatted
to the console
}


class Printer {
+ reset_count()
+ print(state : str, message : str)
}
note left of Printer::print
    * print to console in standardised format.
    Example: [ 1 ][ OK ][ "message" ]

    * maybe also provide an option to log the
    current session in txt/log file. Allows,
    analysing/comparing runs late on.
end note


class Loader {
+ FID: dict

+ load_jMRUI(path : str)
}
note left of Loader::FID
    Example:
    FID["signal"] -> np.array
    FID["parameters"]["LarmorFreq"] -> int
end note
note left of Loader : Instance of this class can be used to \n load lipids or metabolites.



class Mask {
+ FOV : float
+ slice_thickness : float

+ load_nii(path: str)
+ interpolation(voxel_size : int)
}
note left of Mask : Instance can load and handle: B0 Map, \n Metabolite Mask, Fat Mask. For interpolation \n possible PyTorch (form 1,1,x,y,z) or \n scipy.ndimage with (x,y,z).

class MRSIBuilder {
+ FID_lipids : dict
+ FID_metabolites : dict

- load(target : str, source : str)
- build_mrsi_lipids()
- build_mrsi_metabolites()
+ build_mrsi()
}
note right of MRSIBuilder::FID_metabolites
    Examples:
    FID_metabolites["signal"] : np.array
    FID_metabolites["time"] : np.array
end note
note right of MRSIBuilder::load
    Either load data from path or from an
    simulation (class SpectralSimulator). Output
    format from both sources should be identical.
end note
note right of MRSIBuilder::build_mrsi()
    Also brings FID to spectral space.
end note


class SpectralSimulator {
+ metabolites()
+ lipids()
+ water()
+ macromolecules()
+ suppression(target : str)
+ get_spectrum(spectra : list) -> np.array
+ line broadening(spectrum : np.array)
}
note right of SpectralSimulator : Depending on the code style it also \n possible to create just the function simulate() \n with arguments "metabolites", "water", ...
note right of SpectralSimulator::suppression
    Arguments: "Water", "Lipids"
end note
note right of SpectralSimulator::get_spectrum
    To get a sum of the desired spectra.
    For example: get_spectrum(["lipids", "water"])
end note

 Loader ..> Configurator : maybe using paths
 Loader ..> Mask : maybe using paths
 MRSIBuilder - -o Loader : load FID (metabolites, lipids)
 MRSIBuilder - -o SpectralSimulator : load simulated spectra

@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.20.1+1-post-Ubuntu-0ubuntu122.04
Operating System: Linux
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>